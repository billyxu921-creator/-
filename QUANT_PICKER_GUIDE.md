# 量化选股器使用指南

> Quant Picker - AI驱动的量化选股系统

---

## 📋 功能概述

**Quant Picker** 是一个结合量化指标、舆情分析和AI决策的自动化选股系统。

### 核心流程

```
Step 1: AkShare指标初选
    ↓
Step 2: 舆情碰撞 (Sentiment Match)
    ↓
Step 3: DeepSeek终极筛选
    ↓
Step 4: 生成AI潜力股推荐报告
```

---

## 🎯 筛选标准

### Step 1: AkShare指标初选

**数据来源**: 全A股实时行情 (`ak.stock_zh_a_spot_em()`)

**筛选条件**:
- ✅ 60 < 市值 < 200亿
- ✅ 2% < 涨幅 < 6%
- ✅ 换手率 > 5%

**目的**: 筛选出中小市值、有一定涨幅、活跃度高的股票

---

### Step 2: 舆情碰撞

**数据来源**:
- 微博热点数据 (`weibo_clean_*.csv`)
- 小红书热点数据 (`discovery_history/*.json`)

**匹配逻辑**:
1. 检查股票名称/代码是否在舆情数据中被提及
2. 识别关键词（重组、利好、涨停等）
3. 计算博主影响力权重

**加权规则**:
```
博主影响力:
- 100万+粉丝: 权重 ×10
- 10万+粉丝: 权重 ×3
- 其他: 权重 ×1

关键词优先级:
- 高优先级 (重组/并购/收购/入股/利好/涨停/突破): +30分
- 中优先级 (增持/回购/业绩/盈利/分红): +20分
- 低优先级 (关注/看好/推荐): +10分

舆情评分 = (基础分50 + 关键词加分) × 影响力权重
归一化到 0-100
```

**综合得分**:
```
综合得分 = 涨幅 × 30% + 换手率 × 20% + 舆情评分 × 50%
```

---

### Step 3: DeepSeek终极筛选

**输入**: 综合得分TOP 10的股票

**AI任务**:
- 从10只股票中选出3只最具潜力的
- 综合分析技术面和舆情面
- 找出技术面和舆情面的结合点
- 预测短期止盈位（1-3个交易日）

**AI Prompt**:
```
你是一位资深基金经理，拥有20年的A股投资经验。

请从提供的股票列表中选出3只今日最具潜力的股票。

分析要求：
1. 综合考虑技术面（涨幅、换手率、成交量）和舆情面（社交媒体热度、关键词）
2. 找出技术面和舆情面的结合点
3. 给出具体的推荐理由
4. 预测一个短期止盈位（1-3个交易日）
```

---

## 🚀 使用方法

### 1. 安装依赖

```bash
pip install akshare pandas numpy requests
```

### 2. 配置API Key

确保 `config.py` 中已配置DeepSeek API Key。

### 3. 运行选股器

```bash
# 完整运行
python3 Quant_Picker.py

# 运行测试
python3 test_quant_picker.py

# 测试各个组件
python3 test_quant_picker.py --components
```

---

## 📊 输出文件

### 1. AI潜力股推荐报告
**文件名**: `AI潜力股推荐_YYYYMMDD.md`

**内容结构**:
```markdown
# 🚀 AI其他主题潜力股推荐

## 📊 筛选概况
- 初选股票数
- 舆情匹配数
- AI终选数

## 🎯 筛选标准
- Step 1: AkShare指标初选
- Step 2: 舆情碰撞
- Step 3: DeepSeek终极筛选

## 🏆 AI推荐TOP 3

### 1. [股票名称] ([股票代码])
**实时数据**:
- 最新价: XX.XX元
- 涨跌幅: X.XX%
- 换手率: X.XX%
- 市值: XXX.X亿
- 舆情评分: XX.X/100

**推荐理由**: [AI分析]

**技术面分析**:
> [技术指标分析]

**舆情面分析**:
> [社交媒体热度分析]

**技术+舆情结合点**:
> [关键结合点]

**止盈位**: XX.XX元
**预期收益**: X.XX%

**风险提示**: [风险说明]

### 2. ...
### 3. ...

## 📈 整体市场观点
> [AI市场观点]

## 💡 操作策略建议
> [AI操作建议]

## 📋 候选股票列表 (TOP 10)
[详细列表]
```

### 2. 候选股票数据
**文件名**: `quant_picker_candidates_YYYYMMDD.csv`

**字段**:
- 代码
- 名称
- 最新价
- 涨跌幅
- 换手率
- 市值_亿
- 舆情评分
- 舆情来源
- 匹配关键词
- 博主影响力
- 综合得分
- 最新新闻

---

## 📝 使用示例

### 示例1: 完整运行

```python
from Quant_Picker import QuantPicker

# 创建选股器
picker = QuantPicker()

# 运行完整流程
picker.run()
```

**输出**:
```
============================================================
量化选股器 (Quant Picker)
============================================================

============================================================
Step 1: AkShare指标初选
============================================================

正在获取全A股实时行情...
✓ 获取成功，共 5234 只股票

应用筛选条件:
  - 60 < 市值 < 200亿
  - 2% < 涨幅 < 6%
  - 换手率 > 5%

✓ 初选完成，筛选出 45 只股票

【初选股票TOP 10】
------------------------------------------------------------
 1. 某科技   (300XXX) 涨幅: 5.23% 市值: 125.3亿 换手:12.45%
 2. 某新能源 (688XXX) 涨幅: 4.89% 市值:  98.7亿 换手: 8.92%
...

============================================================
Step 2: 舆情碰撞 (Sentiment Match)
============================================================

✓ 加载舆情数据: 156 条

正在匹配舆情数据...

✓ 舆情碰撞完成
  匹配到舆情: 12 只

【舆情匹配TOP 5】
--------------------------------------------------------------------------------
1. 某科技     舆情评分: 85.0 来源:微博        关键词:重组,利好            影响力:×10
2. 某新能源   舆情评分: 72.5 来源:小红书+微博  关键词:突破                影响力:×3
...

============================================================
Step 3: DeepSeek终极筛选
============================================================

选取综合得分TOP 10 只股票进行AI分析...

正在获取股票新闻...

输入字数: 1234 字

正在调用DeepSeek API进行终极筛选...
✓ AI筛选完成

============================================================
Step 4: 生成AI潜力股推荐报告
============================================================

✓ 报告已保存: AI潜力股推荐_20260115.md

============================================================
✅ 量化选股完成！
============================================================

生成文件:
  - AI推荐报告: AI潜力股推荐_20260115.md
  - 候选股票数据: quant_picker_candidates_20260115.csv

【AI推荐TOP 3】
------------------------------------------------------------
1. 某科技 (300XXX)
   止盈位: 25.80元 | 预期收益: 8.5%
   理由: 技术面突破前高+舆情面重组预期强烈...

2. 某新能源 (688XXX)
   止盈位: 42.50元 | 预期收益: 6.2%
   理由: 换手率放大+小红书热度持续上升...

3. 某医药 (002XXX)
   止盈位: 18.90元 | 预期收益: 5.8%
   理由: 成交量突破+微博大V推荐...
```

---

## ⚠️ 注意事项

### 1. 运行时间

**推荐**: 交易日 9:30-15:00

**原因**:
- 实时行情数据更准确
- 涨幅、换手率等指标更有效

### 2. 数据依赖

**必需数据**:
- ✅ AkShare实时行情（自动获取）
- ⚠️  微博舆情数据（需先运行 `weibo_sentiment_weighted.py`）
- ⚠️  小红书舆情数据（需先运行 `Discovery_Engine.py`）

**建议流程**:
```bash
# 1. 先抓取舆情数据
python3 weibo_sentiment_weighted.py
python3 Discovery_Engine.py

# 2. 再运行量化选股
python3 Quant_Picker.py
```

### 3. API限制

- DeepSeek API有调用频率限制
- 建议每天运行1-2次
- 避免频繁调用

### 4. 市场风险

- ⚠️  本工具仅供参考，不构成投资建议
- ⚠️  股票投资有风险，入市需谨慎
- ⚠️  请结合自身风险承受能力做决策

---

## 🔧 自定义配置

### 1. 修改筛选条件

编辑 `Quant_Picker.py` 第85-95行：

```python
# 原配置
mask = (
    (df['市值_亿'] > 60) & 
    (df['市值_亿'] < 200) &
    (df['涨跌幅'] > 2) & 
    (df['涨跌幅'] < 6) &
    (df['换手率'] > 5)
)

# 自定义配置（更激进）
mask = (
    (df['市值_亿'] > 50) &   # 降低市值下限
    (df['市值_亿'] < 300) &  # 提高市值上限
    (df['涨跌幅'] > 3) &     # 提高涨幅下限
    (df['涨跌幅'] < 8) &     # 提高涨幅上限
    (df['换手率'] > 8)       # 提高换手率要求
)
```

### 2. 修改关键词

编辑 `Quant_Picker.py` 第45-49行：

```python
# 原配置
self.sentiment_keywords = {
    'high_priority': ['重组', '并购', '收购', '入股', '利好', '涨停', '突破'],
    'medium_priority': ['增持', '回购', '业绩', '盈利', '分红'],
    'low_priority': ['关注', '看好', '推荐']
}

# 自定义配置
self.sentiment_keywords = {
    'high_priority': ['重组', '并购', '涨停', '翻倍', '暴涨'],
    'medium_priority': ['增持', '回购', '利好', '突破'],
    'low_priority': ['关注', '看好']
}
```

### 3. 修改综合得分权重

编辑 `Quant_Picker.py` 第235-239行：

```python
# 原配置: 涨幅30% + 换手率20% + 舆情50%
df_stocks['综合得分'] = (
    df_stocks['涨跌幅'] * 0.3 +
    df_stocks['换手率'] * 0.2 +
    df_stocks['舆情评分'] * 0.5
)

# 自定义配置: 更重视舆情
df_stocks['综合得分'] = (
    df_stocks['涨跌幅'] * 0.2 +
    df_stocks['换手率'] * 0.1 +
    df_stocks['舆情评分'] * 0.7
)
```

---

## 🐛 常见问题

### Q1: AkShare数据获取失败

**解决方案**:
```bash
# 更新akshare
pip install --upgrade akshare

# 检查网络连接
ping www.eastmoney.com
```

### Q2: 未找到舆情数据

**解决方案**:
```bash
# 先运行舆情抓取
python3 weibo_sentiment_weighted.py
python3 Discovery_Engine.py

# 再运行量化选股
python3 Quant_Picker.py
```

### Q3: AI分析失败

**解决方案**:
```bash
# 测试API连接
python3 test_api_key.py

# 检查API Key配置
cat config.py | grep api_key
```

### Q4: 初选股票数为0

**可能原因**:
- 市场整体涨幅不足
- 筛选条件过于严格
- 非交易时间

**解决方案**:
- 放宽筛选条件
- 在交易时间运行

---

## 📚 相关文档

- **微博情绪分析**: [WEIGHTED_SENTIMENT_GUIDE.md](WEIGHTED_SENTIMENT_GUIDE.md)
- **全网热点发现**: [DISCOVERY_ENGINE_GUIDE.md](DISCOVERY_ENGINE_GUIDE.md)
- **项目总结**: [PROJECT_SUMMARY.md](PROJECT_SUMMARY.md)

---

**版本**: v1.0  
**发布日期**: 2026-01-15  
**状态**: ✅ 已完成

---

🚀 **立即体验AI驱动的量化选股！**

```bash
python3 Quant_Picker.py
```
