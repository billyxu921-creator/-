# 全网热点发现引擎 (Discovery Engine)

> 自动识别小红书和微博上讨论度异常升高的股票板块

---

## 🎯 核心功能

- **多源探测**: 小红书财经频道 + 微博财经热搜 + 股票超话
- **智能对比**: AI分析今日vs昨日词频变化，识别热门板块
- **反爬避让**: 随机等待5.5-12.2秒、拟人滚动、验证码提示
- **自动简报**: 生成Markdown格式的【全网雷达报告】

---

## 📦 文件说明

| 文件 | 说明 |
|------|------|
| `Discovery_Engine.py` | 主程序（全网热点发现引擎） |
| `test_discovery_engine.py` | 测试脚本 |
| `DISCOVERY_ENGINE_GUIDE.md` | 详细使用指南 |
| `config.py` | 配置文件（DeepSeek API Key） |

---

## 🚀 快速开始

### 1. 安装依赖

```bash
pip install playwright pandas requests
playwright install chromium
```

### 2. 配置API Key

确保 `config.py` 中已配置DeepSeek API Key。

### 3. 运行程序

```bash
# 直接运行
python Discovery_Engine.py

# 或运行测试（减少抓取量）
python test_discovery_engine.py
```

### 4. 登录提示

- 程序会自动打开浏览器
- 遇到登录页面时，手动扫码或输入账号密码
- 登录完成后，在终端按回车继续

---

## 📊 输出文件

### 1. 原始数据
- **文件名**: `discovery_raw_YYYYMMDD_HHMMSS.csv`
- **内容**: 所有抓取的原始数据

### 2. 全网雷达简报
- **文件名**: `全网雷达报告_YYYYMMDD.md`
- **内容**: AI分析的热门板块、增长率、火爆原因

### 3. 历史数据
- **路径**: `discovery_history/discovery_YYYYMMDD.json`
- **用途**: 供次日对比分析

---

## 🔥 简报示例

```markdown
# 【全网雷达：你可能错过的热门机会】

## 🔥 讨论度异常升高的板块 TOP 3

### 1. 煤炭板块 🚀
**增长率**: 250%
**讨论热度**:
- 今日提及: 45 次
- 昨日提及: 13 次

**火爆原因**: 政策催化，煤炭保供政策出台
**置信度**: 85%

### 2. 核电板块 🚀
**增长率**: 180%
...
```

---

## ⚠️ 重要提示

### 反爬策略（强制执行）

1. **headless=False**: 显示浏览器，支持扫码登录
2. **随机等待**: 5.5-12.2秒（不要修改）
3. **拟人滚动**: 缓慢分步滚动
4. **验证码提示**: 蜂鸣声 + emoji提示

### 使用建议

1. **每天运行1次**（建议早上9点）
2. **连续运行3-5天**（积累历史数据）
3. **不要频繁运行**（避免被封）
4. **理性看待结果**（热度 ≠ 投资价值）

---

## 🐛 常见问题

### Q: 浏览器无法启动
```bash
playwright install chromium
```

### Q: 登录后仍提示需要登录
- 等待页面完全加载后再按回车
- 或重新运行程序

### Q: 抓取数据为空
- 检查网络连接
- 页面可能已更新，需要调整选择器

### Q: AI分析失败
```bash
# 测试API连接
python test_api_key.py
```

---

## 📚 详细文档

请查看 **[DISCOVERY_ENGINE_GUIDE.md](DISCOVERY_ENGINE_GUIDE.md)** 获取：

- 详细使用说明
- 工作流程图
- 技术架构
- 最佳实践
- 故障排查

---

## 🎯 工作流程

```
┌─────────────┐
│  小红书抓取  │ (50条笔记)
└──────┬──────┘
       │
       ├──────> ┌──────────────┐
       │        │  保存今日数据 │
┌──────┴──────┐ └──────┬───────┘
│  微博抓取    │        │
│ (热搜+超话) │        │
└──────┬──────┘        │
       │               │
       └───────────────┤
                       │
              ┌────────┴────────┐
              │  加载昨日数据    │
              └────────┬────────┘
                       │
              ┌────────┴────────┐
              │  AI词频对比分析  │
              │  (DeepSeek API) │
              └────────┬────────┘
                       │
              ┌────────┴────────┐
              │  生成雷达简报    │
              │  (Markdown)     │
              └─────────────────┘
```

---

## 🔧 技术栈

- **Python 3.7+**
- **Playwright**: 浏览器自动化
- **Pandas**: 数据处理
- **DeepSeek API**: AI分析
- **Requests**: HTTP请求

---

## ⚖️ 免责声明

1. 仅供学习和研究使用
2. 请遵守平台服务条款
3. 不要过度频繁抓取
4. 社交媒体数据不构成投资建议
5. 投资有风险，决策需谨慎

---

## 📞 相关文件

- **配置文件**: `config.py`
- **测试脚本**: `test_discovery_engine.py`
- **详细指南**: `DISCOVERY_ENGINE_GUIDE.md`
- **API测试**: `test_api_key.py`

---

**版本**: v1.0  
**更新日期**: 2026-01-15  
**状态**: ✅ 已完成
