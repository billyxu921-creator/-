# 📊 模块关系图

## 系统架构图

```
┌─────────────────────────────────────────────────────────────────┐
│                    每日自动推送系统 📧                            │
│                  (daily_email_sender.py)                         │
│                                                                   │
│  每天早上8点自动触发，运行所有模块，汇总生成简报，发送邮件      │
└─────────────────────────────────────────────────────────────────┘
                              │
                              │ 调用所有模块
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│                        5大核心分析模块                            │
└─────────────────────────────────────────────────────────────────┘
         │              │              │              │              │
         ▼              ▼              ▼              ▼              ▼
    ┌────────┐    ┌────────┐    ┌────────┐    ┌────────┐    ┌────────┐
    │黄金股票│    │AI量化  │    │微博情绪│    │全网热点│    │政客交易│
    │筛选 🏆│    │选股 🤖│    │分析 📱│    │发现 🔍│    │追踪 🏛️│
    └────────┘    └────────┘    └────────┘    └────────┘    └────────┘
         │              │              │              │              │
         ▼              ▼              ▼              ▼              ▼
    ┌────────┐    ┌────────┐    ┌────────┐    ┌────────┐    ┌────────┐
    │AkShare │    │AkShare │    │微博API │    │小红书  │    │Quiver  │
    │        │    │+舆情   │    │Playwright│  │微博    │    │Twitter │
    └────────┘    └────────┘    └────────┘    └────────┘    └────────┘
         │              │              │              │              │
         └──────────────┴──────────────┴──────────────┴──────────────┘
                                       │
                                       ▼
                              ┌─────────────┐
                              │ DeepSeek AI │
                              │  深度分析   │
                              └─────────────┘
                                       │
                                       ▼
                              ┌─────────────┐
                              │  生成报告   │
                              │  MD + CSV   │
                              └─────────────┘
                                       │
                                       ▼
                              ┌─────────────┐
                              │  邮件推送   │
                              │  SMTP       │
                              └─────────────┘
```

---

## 数据流向图

```
数据源层                分析层                  AI层                输出层
────────              ────────              ────────            ────────

AkShare               黄金股票筛选                                CSV文件
  │                      │                                         │
  ├──────────────────────┤                                         │
  │                      │                                         │
  │                   AI量化选股                                   │
  │                      │                                         │
  │                      ├──────────────► DeepSeek ──────────► MD报告
  │                      │                   AI                    │
微博                  微博情绪分析              分析                 │
  │                      │                   引擎                  │
  ├──────────────────────┤                    │                   │
  │                      │                    │                   │
小红书               全网热点发现                │                   │
  │                      │                    │                   │
  ├──────────────────────┤                    │                   │
  │                      │                    │                   │
Quiver              政客交易追踪                │                   │
Twitter                  │                    │                   │
  │                      │                    │                   │
  └──────────────────────┴────────────────────┘                   │
                                                                   │
                                                                   ▼
                                                          ┌─────────────┐
                                                          │ 综合简报    │
                                                          │ + 所有附件  │
                                                          └─────────────┘
                                                                   │
                                                                   ▼
                                                          ┌─────────────┐
                                                          │ 邮件推送    │
                                                          │ 📧          │
                                                          └─────────────┘
```

---

## 模块依赖关系

```
每日推送系统
    │
    ├─── 依赖 ───► 黄金股票筛选
    │                  │
    │                  └─── 依赖 ───► AkShare
    │
    ├─── 依赖 ───► AI量化选股
    │                  │
    │                  ├─── 依赖 ───► AkShare
    │                  ├─── 依赖 ───► 微博数据（可选）
    │                  └─── 依赖 ───► DeepSeek API
    │
    ├─── 依赖 ───► 微博情绪分析
    │                  │
    │                  ├─── 依赖 ───► Playwright
    │                  ├─── 依赖 ───► 微博账号
    │                  └─── 依赖 ───► DeepSeek API
    │
    ├─── 依赖 ───► 全网热点发现
    │                  │
    │                  ├─── 依赖 ───► Playwright
    │                  ├─── 依赖 ───► 小红书账号
    │                  ├─── 依赖 ───► 微博账号
    │                  └─── 依赖 ───► DeepSeek API
    │
    ├─── 依赖 ───► 政客交易追踪
    │                  │
    │                  ├─── 依赖 ───► Quiver API（可选）
    │                  ├─── 依赖 ───► Twitter API（可选）
    │                  └─── 依赖 ───► DeepSeek API
    │
    └─── 依赖 ───► SMTP邮件服务
                       │
                       └─── 依赖 ───► QQ邮箱授权码
```

---

## 运行时序图

```
时间轴                     模块执行顺序
────────────────────────────────────────────────────────

08:00:00  ┌──────────────────────────────────────┐
          │  定时任务触发                         │
          └──────────────────────────────────────┘
              │
08:00:01      ▼
          ┌──────────────────────────────────────┐
          │  1. 黄金股票筛选 (2-3分钟)           │
          └──────────────────────────────────────┘
              │
08:03:00      ▼
          ┌──────────────────────────────────────┐
          │  2. AI量化选股 (5-8分钟)             │
          └──────────────────────────────────────┘
              │
08:11:00      ▼
          ┌──────────────────────────────────────┐
          │  3. 微博情绪分析 (5-10分钟)          │
          └──────────────────────────────────────┘
              │
08:21:00      ▼
          ┌──────────────────────────────────────┐
          │  4. 全网热点发现 (10-15分钟)         │
          └──────────────────────────────────────┘
              │
08:36:00      ▼
          ┌──────────────────────────────────────┐
          │  5. 政客交易追踪 (3-5分钟)           │
          └──────────────────────────────────────┘
              │
08:41:00      ▼
          ┌──────────────────────────────────────┐
          │  6. 生成综合简报 (1分钟)             │
          └──────────────────────────────────────┘
              │
08:42:00      ▼
          ┌──────────────────────────────────────┐
          │  7. 发送邮件 (1分钟)                 │
          └──────────────────────────────────────┘
              │
08:43:00      ▼
          ┌──────────────────────────────────────┐
          │  ✅ 完成！邮件已发送                 │
          └──────────────────────────────────────┘

总耗时: 约40-45分钟
```

---

## 模块交互图

```
                    ┌─────────────────┐
                    │   用户邮箱      │
                    │   📧            │
                    └────────▲────────┘
                             │
                             │ 接收简报
                             │
                    ┌────────┴────────┐
                    │  邮件推送系统   │
                    │  SMTP           │
                    └────────▲────────┘
                             │
                             │ 汇总报告
                             │
        ┌────────────────────┼────────────────────┐
        │                    │                    │
        │                    │                    │
   ┌────┴────┐         ┌────┴────┐         ┌────┴────┐
   │ 模块1-2 │         │ 模块3-4 │         │ 模块5   │
   │ 基础分析│         │ 舆情分析│         │ 政策分析│
   └────┬────┘         └────┬────┘         └────┬────┘
        │                   │                    │
        │                   │                    │
   ┌────┴────┐         ┌────┴────┐         ┌────┴────┐
   │ AkShare │         │Playwright│         │ Quiver  │
   │ 数据源  │         │ 浏览器  │         │ API     │
   └─────────┘         └─────────┘         └─────────┘
        │                   │                    │
        └───────────────────┼────────────────────┘
                            │
                            │ 所有模块都调用
                            │
                    ┌───────┴────────┐
                    │  DeepSeek AI   │
                    │  分析引擎      │
                    └────────────────┘
```

---

## 文件关系图

```
项目根目录
│
├── 核心模块 (5个)
│   ├── gold_stock_screener.py ────► 生成 ────► gold_stocks_analysis_*.csv
│   ├── Quant_Picker.py ───────────► 生成 ────► AI潜力股推荐_*.md
│   ├── weibo_sentiment_weighted.py ► 生成 ────► 微博黄金情绪分析_*.md
│   ├── Discovery_Engine.py ───────► 生成 ────► 全网雷达_*.md
│   └── politician_trade_tracker.py ► 生成 ────► 权力资金动态_*.md
│
├── 推送系统 (3个)
│   ├── daily_email_sender.py ─────► 调用所有模块 ────► 发送邮件
│   ├── github_daily_sender.py ────► 调用部分模块 ────► 发送邮件
│   └── schedule_daily_report.py ──► 定时调度 ────────► 运行推送
│
├── 测试脚本 (5个)
│   ├── test_quant_picker.py
│   ├── test_weighted_sentiment.py
│   ├── test_politician_tracker.py
│   ├── test_config.py
│   └── test_discovery_engine.py
│
├── 配置文件 (2个)
│   ├── config.py ─────────────────► 所有模块读取配置
│   └── config.example.py ─────────► 配置模板
│
├── 部署工具 (2个)
│   ├── deploy_to_github.sh ───────► 一键部署到GitHub
│   └── run_with_politician_tracker.py ► 运行所有模块
│
└── 文档系统 (24个)
    ├── README.md ─────────────────► 项目总览
    ├── START_HERE_GITHUB.md ──────► 快速开始
    ├── COMPLETE_MODULES_OVERVIEW.md ► 本文档
    └── ... (其他21个文档)
```

---

## 配置依赖图

```
config.py (配置中心)
    │
    ├─── DEEPSEEK_CONFIG
    │       │
    │       ├─── 被使用 ───► AI量化选股
    │       ├─── 被使用 ───► 微博情绪分析
    │       ├─── 被使用 ───► 全网热点发现
    │       └─── 被使用 ───► 政客交易追踪
    │
    ├─── EMAIL_CONFIG
    │       │
    │       └─── 被使用 ───► 邮件推送系统
    │
    ├─── QUIVER_CONFIG (可选)
    │       │
    │       └─── 被使用 ───► 政客交易追踪
    │
    └─── SCHEDULE_CONFIG
            │
            └─── 被使用 ───► 定时调度系统
```

---

## 数据流转图

```
第1步: 数据采集
─────────────────
AkShare ──────────────► 股票实时数据
微博 ─────────────────► 情绪数据
小红书 ───────────────► 热点数据
Quiver ───────────────► 政客交易数据
Twitter ──────────────► 讨论数据

第2步: 数据清洗
─────────────────
原始数据 ─────────────► 过滤广告
         ─────────────► 去重
         ─────────────► 格式化
         ─────────────► 清洗后数据

第3步: 数据分析
─────────────────
清洗后数据 ───────────► 技术指标计算
           ───────────► 舆情加权计算
           ───────────► 置信度评分
           ───────────► 分析结果

第4步: AI增强
─────────────────
分析结果 ─────────────► DeepSeek API
         ─────────────► 深度分析
         ─────────────► 推荐理由
         ─────────────► AI报告

第5步: 报告生成
─────────────────
AI报告 ───────────────► Markdown格式化
       ───────────────► CSV数据导出
       ───────────────► 综合简报汇总
       ───────────────► 最终报告

第6步: 邮件推送
─────────────────
最终报告 ─────────────► SMTP发送
         ─────────────► 添加附件
         ─────────────► 用户邮箱
```

---

**这就是整个系统的模块关系！** 📊

所有模块相互配合，形成一个完整的自动化投资分析系统。

---

**最后更新**: 2026年1月15日
